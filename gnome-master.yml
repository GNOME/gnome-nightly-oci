FROM flatpak/flatpak-builder:base

RUN dnf install -y git xorg-x11-server-Xvfb && dnf clean all

RUN flatpak remote-add gnome --if-not-exists https://sdk.gnome.org/gnome.flatpakrepo
RUN flatpak install gnome org.gnome.Sdk//3.28 org.gnome.Platform//3.28

# Add a machine-id as specified in the freedesktop spec:
# https://www.freedesktop.org/software/systemd/man/machine-id.html
# gnome-builder test suite depends on this
RUN cat /dev/urandom | tr -dc a-f0-9 | head -c32 > /etc/machine-id && echo "" >> /etc/machine-id
